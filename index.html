<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>DJ MASTER PRO v3 - High Quality</title>
    <style>
        body { background: #0a0a0a; color: #00ffcc; font-family: sans-serif; text-align: center; padding: 50px; }
        .box { border: 2px solid #00ffcc; padding: 40px; border-radius: 20px; background: #111; max-width: 500px; margin: auto; box-shadow: 0 0 20px #00ffcc; }
        button { background: #00ffcc; color: #000; border: none; padding: 15px 30px; font-weight: bold; border-radius: 10px; cursor: pointer; margin: 10px; }
        #visualizer { width: 100%; height: 100px; background: #000; margin-top: 20px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="box">
    <h1>ðŸŽ§ DJ MASTER ENGINE</h1>
    <p>ÃŽncarcÄƒ melodiile de pe YouTube (MP3)</p>
    <input type="file" id="upload" multiple accept="audio/*"><br><br>
    <button id="startBtn">START MASTERING & PLAY</button>
    <canvas id="visualizer"></canvas>
    <div id="status">Status: AÈ™teptare...</div>
</div>

<script>
    let audioCtx;
    let selectedFiles = [];

    // MemorÄƒm fiÈ™ierele selectate conform cerinÈ›ei tale [2026-01-15]
    document.getElementById('upload').onchange = (e) => {
        selectedFiles = Array.from(e.target.files).slice(0, 10);
        document.getElementById('status').innerText = `Ai Ã®ncÄƒrcat ${selectedFiles.length} piese.`;
    };

    document.getElementById('startBtn').onclick = async () => {
        if (!selectedFiles.length) return alert("Pune niÈ™te piese!");
        
        // ActivÄƒm contextul audio la click (RegulÄƒ Chrome)
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') await audioCtx.resume();

        document.getElementById('status').innerText = "Procesare... Se aude acum cu Mastering!";

        for (let file of selectedFiles) {
            const data = await file.arrayBuffer();
            const buffer = await audioCtx.decodeAudioData(data);
            playWithMastering(buffer);
        }
    };

    function playWithMastering(buffer) {
        const source = audioCtx.createBufferSource();
        source.buffer = buffer;

        // --- NODURI DE PROCESARE ---
        const compressor = audioCtx.createDynamicsCompressor();
        compressor.threshold.value = -20;
        compressor.ratio.value = 12;

        const lowBoost = audioCtx.createBiquadFilter();
        lowBoost.type = "lowshelf";
        lowBoost.frequency.value = 80;
        lowBoost.gain.value = 6; // Bas mai puternic pentru DJ

        const highClarity = audioCtx.createBiquadFilter();
        highClarity.type = "highshelf";
        highClarity.frequency.value = 10000;
        highClarity.gain.value = 4; // ReparÄƒm Ã®naltele din YouTube

        // Conectare
        source.connect(lowBoost);
        lowBoost.connect(highClarity);
        highClarity.connect(compressor);
        compressor.connect(audioCtx.destination);

        source.start(0);
    }
</script>
</body>
</html>
